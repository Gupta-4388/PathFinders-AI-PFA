
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user within the PathFinder AI application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "googleId": {
          "type": "string",
          "description": "The user's Google ID, obtained from Google authentication."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile photo.",
          "format": "uri"
        },
        "resumeId": {
          "type": "string",
          "description": "Reference to Resume entity. (Relationship: User 1:1 Resume)"
        },
        "aiMentorId": {
          "type": "string",
          "description": "Reference to AIMentor entity. (Relationship: User 1:1 AIMentor)"
        },
        "careerDashboardId": {
          "type": "string",
          "description": "Reference to CareerDashboard entity. (Relationship: User 1:1 CareerDashboard)"
        }
      },
      "required": [
        "id",
        "googleId",
        "email",
        "displayName"
      ]
    },
    "Resume": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Resume",
      "type": "object",
      "description": "Represents a user's resume, including parsed skills, projects, and analysis results.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resume entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 Resume)"
        },
        "rawText": {
          "type": "string",
          "description": "The raw text content of the uploaded resume."
        },
        "parsedSkills": {
          "type": "array",
          "description": "List of skills extracted from the resume.",
          "items": {
            "type": "string"
          }
        },
        "parsedProjects": {
          "type": "array",
          "description": "List of projects extracted from the resume.",
          "items": {
            "type": "string"
          }
        },
        "analysisResults": {
          "type": "string",
          "description": "AI-driven analysis results and improvement insights for the resume (JSON format)."
        }
      },
      "required": [
        "id",
        "userId",
        "rawText"
      ]
    },
    "AIMentor": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AIMentor",
      "type": "object",
      "description": "Represents the personalized career guidance and mentorship suggestions provided by the AI.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the AI Mentor entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 AIMentor)"
        },
        "careerGuidance": {
          "type": "string",
          "description": "Personalized career guidance from AI."
        },
        "mentorshipSuggestions": {
          "type": "string",
          "description": "Mentorship suggestions from AI."
        },
        "skillGrowthRoadmap": {
          "type": "string",
          "description": "Skill growth roadmap from AI."
        },
        "learningResources": {
          "type": "array",
          "description": "List of recommended learning resources (URLs).",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userId"
      ]
    },
    "CareerDashboard": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CareerDashboard",
      "type": "object",
      "description": "Represents the user's career dashboard, visualizing skill gaps, growth paths, and job recommendations.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Career Dashboard entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 CareerDashboard)"
        },
        "recommendedRoles": {
          "type": "array",
          "description": "List of recommended job roles.",
          "items": {
            "type": "string"
          }
        },
        "skillGaps": {
          "type": "string",
          "description": "Visualization data for skill gaps."
        },
        "growthPaths": {
          "type": "string",
          "description": "Visualization data for growth paths."
        },
        "salaryRanges": {
          "type": "string",
          "description": "Visualization data for salary ranges."
        },
        "learningTimeline": {
          "type": "string",
          "description": "Visualization data for the learning timeline."
        }
      },
      "required": [
        "id",
        "userId"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. The `userId` is obtained from Firebase Authentication.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, derived from Firebase Authentication's `uid`."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumes/{resumeId}",
        "definition": {
          "entityName": "Resume",
          "schema": {
            "$ref": "#/backend/entities/Resume"
          },
          "description": "Stores resume data for a specific user. The `userId` links to the user who owns the resume.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, derived from Firebase Authentication's `uid`."
            },
            {
              "name": "resumeId",
              "description": "The unique identifier for the resume."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/aiMentors/{aiMentorId}",
        "definition": {
          "entityName": "AIMentor",
          "schema": {
            "$ref": "#/backend/entities/AIMentor"
          },
          "description": "Stores AI mentor data for a specific user. The `userId` links to the user who owns the AI mentor data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, derived from Firebase Authentication's `uid`."
            },
            {
              "name": "aiMentorId",
              "description": "The unique identifier for the AI mentor data."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/careerDashboards/{careerDashboardId}",
        "definition": {
          "entityName": "CareerDashboard",
          "schema": {
            "$ref": "#/backend/entities/CareerDashboard"
          },
          "description": "Stores career dashboard data for a specific user. The `userId` links to the user who owns the career dashboard data.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user, derived from Firebase Authentication's `uid`."
            },
            {
              "name": "careerDashboardId",
              "description": "The unique identifier for the career dashboard data."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to be secure, scalable, and easily debuggable, adhering to the core principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), and QAPs (Rules are not Filters).  Since the User document contains all the IDs for associated entities like `Resume`, `AIMentor`, and `CareerDashboard`, all the data required to build the dashboard can be retrieved from the `/users/{userId}` document. The key design strategy is to use hierarchical paths for user-owned data, enabling straightforward ownership-based security rules without relying on complex `get()` calls in security rules (Authorization Independence). Each top-level entity is directly owned by a user via a hierarchical path (e.g., `/users/{userId}/resumes/{resumeId}`), eliminating the need to denormalize authorization data, and facilitating simple, secure `list` operations. This design supports secure data access, with each user having sole access to their own data, including resume, AI mentor, and career dashboard information. This segregation inherently satisfies QAPs. The use of path-based ownership avoids the complexity of managing shared access or roles, streamlining the security rules and making them more maintainable."
  }
}
